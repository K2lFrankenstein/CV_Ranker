<!-- index.html -->
<script src="https://apis.google.com/js/platform.js" async defer></script>
<meta name="google-signin-client_id" content="YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com">

<script>
  function onSignIn(googleUser) {
    var id_token = googleUser.getAuthResponse().id_token;
    
    // Send the ID token to your backend
    fetch('/login/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ id_token: id_token }),
    })
    .then(response => response.json())
    .then(data => {
      if (data.firebase_token) {
        console.log('Firebase token:', data.firebase_token);
        // Handle successful login, e.g., redirect or update UI
      } else {
        console.error('Login failed:', data.error);
      }
    })
    .catch((error) => {
      console.error('Error:', error);
    });
  }

  function onSignOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function () {
      console.log('User signed out.');
      
      // Notify backend of logout
      fetch('/logout/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
      })
      .then(response => response.json())
      .then(data => {
        console.log('Success:', data);
      })
      .catch((error) => {
        console.error('Error:', error);
      });
    });
  }
</script>

<div class="g-signin2" data-onsuccess="onSignIn"></div>
<button onclick="onSignOut()">Sign out</button>
